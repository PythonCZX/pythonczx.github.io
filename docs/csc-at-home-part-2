<!DOCTYPE html><html lang="en" data-theme="classic"><head><title>CSC at Home (Part 2): Software Inventory and Control</title><link rel="shortcut icon" href="/assets/img/favicon.ico"><link rel="alternate" type="application/rss+xml" title="All Content Feed" href="https://shellsharks.com/feeds/all-feed.xml"><link rel="alternate" type="application/rss+xml" title="Post Feed" href="https://shellsharks.com/feeds/feed.xml"><link rel="alternate" type="application/rss+xml" title="Scrolls Feed" href="https://shellsharks.com/feeds/scroll-feed.xml"><link rel="alternate" type="application/rss+xml" title="Infosec Feed" href="https://shellsharks.com/feeds/infosec-feed.xml"><link rel="alternate" type="application/rss+xml" title="Notes Feed" href="https://shellsharks.com/feeds/note-feed.xml"><link rel="alternate" type="application/rss+xml" title="Devlogs Feed" href="https://shellsharks.com/feeds/devlog-feed.xml"><link rel="alternate" type="application/rss+xml" title="Links Feed" href="https://shellsharks.com/feeds/link-feed.xml"><link rel="alternate" type="application/rss+xml" title="Captains Log Feed" href="https://shellsharks.com/feeds/log-feed.xml"><link rel="alternate" type="application/rss+xml" title="Social Web Feed" href="https://shellsharks.com/feeds/socialweb-feed.xml"><link rel="alternate" type="application/rss+xml" title="Life Feed" href="https://shellsharks.com/feeds/life-feed.xml"><link rel="blogroll" type="text/xml" href="https://shellsharks.com/assets/rsrc/shellsharks-blogroll.opml"><link type="text/plain" rel="author" href="https://shellsharks.com/humans.txt" /><link rel="canonical" href="https://shellsharks.com/csc-at-home-part-2"><link rel="apple-touch-icon" href="/assets/img/apple-touch-icon.png"><link rel="indieweb" href="/indieweb.txt" /><link href="https://github.com/shellsharks" rel="me"> <!--IndieAuth Provider--><link rel="authorization_endpoint" href="https://indieauth.com/auth"> <!--IndieAuth--><link rel="token_endpoint" href="https://tokens.indieauth.com/token"> <!--IndieAuth token endpoint--> <!--needed for button css--><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous"><link href='/assets/css/style.css' rel='stylesheet' type='text/css'><link href="/assets/css/syntax.css" rel="stylesheet" ><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/regular/style.css" /><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/fill/style.css" /><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/bold/style.css" /><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="Michael Sass" /><meta name="description" content="Practical guidance for implementing CIS Control 2, Inventory and Control of Software Assets, in small environments." /><meta name="keywords" content="CSC at Home (Part 2): Software Inventory and Control, shellsharks, infosec, cis, csc, openvas, vm, scanning, blopomo, weblogpomo2024" /><meta content="shellsharks" property="og:site_name" /><meta name="fediverse:creator" content="@shellsharks@shellsharks.social" /><meta name="robots" content="noai, noimageai, noml" /> <!--https://noml.info--> <script> const currentThemeX = localStorage.getItem('theme') ? localStorage.getItem('theme') : null; if (currentThemeX) { document.documentElement.setAttribute('data-theme', currentThemeX); } else if (matchMedia('(prefers-color-scheme: light)').matches) { localStorage.setItem('theme', "light"); } else if (matchMedia('(prefers-color-scheme: dark)').matches) { localStorage.setItem('theme', "classic"); } else { localStorage.setItem('theme', "classic"); } </script><meta content="CSC at Home (Part 2): Software Inventory and Control" property="og:title"><meta content="article" property="og:type"><meta content="Practical guidance for implementing CIS Control 2, Inventory and Control of Software Assets, in small environments." property="og:description"><meta content="https://shellsharks.com/csc-at-home-part-2" property="og:url"><meta content="2024-05-12T09:00:00-04:00" property="article:published_time"><meta content="https://shellsharks.com/about/" property="article:author"><meta content="https://shellsharks-images.s3.amazonaws.com/surfshark.png" property="og:image"> <!--<meta content="https://shellsharks-images.s3.amazonaws.com/shellsharks.png" property="og:image">--><meta content="infosec" property="article:section"><meta content="infosec" property="article:tag"><meta content="cis" property="article:tag"><meta content="csc" property="article:tag"><meta content="openvas" property="article:tag"><meta content="vm" property="article:tag"><meta content="scanning" property="article:tag"><meta content="blopomo" property="article:tag"><meta content="weblogpomo2024" property="article:tag"> <script src="/assets/js/finrand.js"></script><style> @media (max-width: 2048px) { main { width:66%; } } @media (max-width: 1800px) { main { max-width:800px; width:95%; } } @media (max-width: 768px) { main { width:95%; } }</style><body><div class="container"><heading class="container_item"><style> /* * Made by Erik Terwan * 24th of November 2015 * MIT License * * * If you are thinking of using this in * production code, beware of the browser * prefixes. */ #menuToggle { display: block; position: relative; z-index: 1; -webkit-user-select: none; user-select: none; } #menuToggle a { text-decoration: none; transition: color 0.3s ease; color: var(--contrast-font-color); } .menu_section { color: var(--light-font-color); font-weight: 900; } .menu_section:nth-of-type(n+2) { margin-top:20px; } #menuToggle a:hover { color: var(--link-hover-color); } #menuToggle input { display: block; width: 40px; height: 32px; position: absolute; /*top: -7px;*/ /*left: -5px;*/ cursor: pointer; opacity: 0; /* hide this */ z-index: 2; /* and place it over the hamburger */ -webkit-touch-callout: none; } /* * Just a quick hamburger */ #menuToggle span { display: block; width: 27px; height: 3px; margin-bottom: 4px; position: relative; margin-top:4px; background: var(--font-color); border-radius: 3px; z-index: 1; transform-origin: 4px 0px; transition: transform 0.5s cubic-bezier(0.77,0.2,0.05,1.0), background 0.5s cubic-bezier(0.77,0.2,0.05,1.0), opacity 0.55s ease; } #menuToggle span:first-child { transform-origin: 0% 0%; } #menuToggle span:nth-last-child(2) { transform-origin: 0% 100%; } /* * Transform all the slices of hamburger * into a crossmark. */ #menuToggle input:checked ~ span { opacity: 1; transform: rotate(45deg) translate(-2px, -1px); background: var(--link-hover-color); } /* * But let's hide the middle one. */ #menuToggle input:checked ~ span:nth-last-child(3) { opacity: 0; transform: rotate(0deg) scale(0.2, 0.2); } /* * Ohyeah and the last one should go the other direction */ #menuToggle input:checked ~ span:nth-last-child(2) { transform: rotate(-45deg) translate(0, -1px); } /* * Make this absolute positioned * at the top left of the screen */ #menu { position: absolute; left:-10px; width: 200px; /*fit-content;*/ padding: 10px; margin-top:10px; /*display:none;*/ background: var(--light-background-color); color:var(--font-color); list-style-type: none; -webkit-font-smoothing: antialiased; max-height: calc(80vh); overflow:auto; overscroll-behavior: contain; border-radius: 5px; /* to stop flickering of text in safari */ } /* * And let's slide it in from the left */ #menuToggle input:checked ~ ul { display:block; } .hidden { display: none; }</style><div role="navigation" id="hamburger"><div id="menuToggle"> <input type="checkbox" /> <span></span> <span></span> <span></span><ul id="menu" class="hidden"><li class="menu_section">Main<li><a href="/home/feed" ><i class="ph ph-house"></i> Home Feed</a><li><a href="/about" ><i class="ph ph-identification-card"></i> About</a><li><a href="/feeds" ><i class="ph ph-rss"></i> Feeds</a><li><a href="/activity" ><i class="ph ph-pulse"></i> Activity</a><li><a href="https://shellsharks.social/@shellsharks" target="_blank"><i class="ph ph-mastodon-logo"></i> Mastodon</a><li><a href="mailto:mike@shellsharks.com" ><i class="ph ph-envelope"></i> Email</a><li><a href="https://ko-fi.com/shellsharks" ><i class="ph ph-coffee"></i> Buy me a Coffee</a><li id="themetoggler"><i class="ph ph-swatches" id="themetoggle"></i> Toggle theme<li class="menu_section">Site Nav<li><a href="/scrolls" ><i class="ph ph-scroll"></i> Scrolls Newsletter</a><li><a href="/podcast" ><i class="ph ph-microphone"></i> The Shellsharks Podcast</a><li><a href="/notebook" ><i class="ph ph-note"></i> Notebook</a><li><a href="/blogs" ><i class="ph ph-article"></i> Blogs</a><li><a href="/blogs/infosec" ><i class="ph ph-bug"></i> Infosec Blogs</a><li><a href="/captains-log" ><i class="ph-fill ph-notebook"></i> Captain's Log</a><li><a href="/devlog" ><i class="ph ph-code-block"></i> Devlog</a><li><a href="/linklog" ><i class="ph ph-link"></i> Linklog</a><li><a href="/blogroll" ><i class="ph ph-paint-roller"></i> Blogroll</a><li><a href="/fediverse" ><i class="ph ph-fediverse-logo"></i> Fediverse ‚ÅÇ</a><li><a href="/slashes" ><i class="ph ph-folder-simple-star"></i> Slashes</a><li><a href="/uses" ><i class="ph ph-hammer"></i> Uses</a><li><a href="/now" ><i class="ph ph-clock"></i> Now</a><li><a href="/tags" ><i class="ph ph-tag"></i> Tags</a><li><a href="/statboard" ><i class="ph ph-gauge"></i> Statboard</a><li><a href="/changelog" ><i class="ph ph-arrows-left-right"></i> Change Log</a><li><a href="/interests" ><i class="ph ph-heart"></i> Interests</a><li><a href="/ideas" ><i class="ph ph-lightbulb-filament"></i> Ideas</a><li><a href="/bookmarks" ><i class="ph ph-bookmarks"></i> Bookmarks</a><li><a href="/resume" ><i class="ph ph-read-cv-logo"></i> Resume</a><li><a href="/pro" ><i class="ph ph-seal"></i> Shellsharks Pro</a><li><a href="/sharkweek" ><i class="ph ph-calendar-heart"></i> >Shark Week</a><li><a href="/architecture" ><i class="ph ph-blueprint"></i> Architecture</a><li><a href="/roadmap" ><i class="ph ph-road-horizon"></i> Roadmap</a><li><a href="/tags?tag=bestof#info" ><i class="ph ph-star"></i> Best</a><li><a href="/projects" ><i class="ph ph-compass-tool"></i> Projects</a><li><a href="/now#supporting" ><i class="ph ph-hand-heart"></i> Supports</a><li><a href="/uses#referrals" ><i class="ph ph-hand-arrow-up"></i> Referrals</a><li><a href="/style" ><i class="ph ph-frame-corners"></i> Style</a><li><a href="/.well-known/security.txt" ><i class="ph ph-bug"></i> Report a Bug</a><li><a href="/humans.txt" ><i class="ph ph-user-rectangle"></i> Humans</a><li><a href="/disclaimer" ><i class="ph ph-info"></i> License & Disclaimer</a><li><a href="/privacy" ><i class="ph ph-cookie"></i> Privacy</a><li><a href="/starsharks" ><i class="ph ph-sparkle"></i> Starsharks</a><li><a href="/chipotle" ><i class="ph ph-pepper"></i> Chipotle</a><li><a href="/misc" ><i class="ph ph-paperclip"></i> Junk Drawer</a><li><a href="/ocean" ><i class="ph ph-waves"></i> the Ocean</a><li><a href="/void" ><i class="ph ph-spiral"></i> the Void</a><li class="menu_section">Other<li><a href="/public.pgp" ><i class="ph ph-key"></i> PGP Public Key</a><li><a href="https://infosec.pub/c/cybersecurity" target="_blank"><i class="ph ph-hamburger"></i> Infosec.Pub</a><li><a href="https://malici.ous.computer/@shellsharks" target="_blank"><i class="ph ph-linux-logo"></i> malici.ous.computer</a><li><a href="https://mastodon.social/@sass" target="_blank"><i class="ph-fill ph-mastodon-logo"></i> Mastodon.Social</a><li><a href="https://discord.gg/3rkHgtcYbb" target="_blank"><i class="ph ph-discord-logo"></i> Shellsharks Discord</a><li><a href="https://www.linkedin.com/in/mikesass" target="_blank"><i class="ph ph-linkedin-logo"></i> Linkedin</a><li><a href="/toots/infosec-exchange/shellsharks/" ><i class="ph ph-database"></i> Infosec.exchange Toot Archive</a><li><a href="https://github.com/shellsharks" target="_blank"><i class="ph ph-github-logo"></i> Github</a><li><a href="https://fediverse-webring-enthusiasts.glitch.me/profiles/shellsharks_infosec.exchange/index.html" target="_blank"><i class="ph ph-circle"></i> Webring Enthusiasts</a><li><a href="https://fedia.io/m/cybersecurity" target="_blank"><i class="ph ph-square-half"></i> Fedia.io</a><li><img src="/assets/img/avatar.png" height="50" style="position: relative; display: block; margin:auto; margin-top:20px; margin-bottom:20px;" /></ul></div></div><!-- window.onload = function() { var menuButton = document.getElementById('menuToggle'); var menu = document.getElementById('menu'); menu.classList.add('hidden'); document.getElementById("menuToggle").children[0].checked = false; } --> <script> const menuButton = document.getElementById('menuToggle'); const menu = document.getElementById('menu'); var links = menu.querySelectorAll('a'); menuButton.addEventListener('click', () => { if (!menu.contains(event.target)) { menu.classList.toggle('hidden'); } }); document.addEventListener('click', (event) => { if (!menu.contains(event.target) && !menuButton.contains(event.target)) { menu.classList.add('hidden'); if (document.getElementById("menuToggle").children[0].checked) { document.getElementById("menuToggle").children[0].checked = !document.getElementById("menuToggle").children[0].checked; } } }); links.forEach(function(link) { link.addEventListener('click', function(event) { document.querySelector("#hamburger").click(); }); }); </script> <img id="title_image" src="/assets/img/shellsharks.gif" alt="Shellsharks>_" onclick='window.open("/","_self")'> <span style="float:right;"><a href="/search"><i class="ph-bold ph-magnifying-glass" style="color:var(--font-color); font-size:1.6em; top:-2px;"></i></a></span> </heading><nav class="container_item"><ul id="nav_menu" style="list-style-type:none;padding-left: 10px;"><li class="menu_section">Main<li><a href="/home/feed" ><i class="ph ph-house"></i> Home Feed</a><li><a href="/about" ><i class="ph ph-identification-card"></i> About</a><li><a href="/feeds" ><i class="ph ph-rss"></i> Feeds</a><li><a href="/activity" ><i class="ph ph-pulse"></i> Activity</a><li><a href="https://shellsharks.social/@shellsharks" target="_blank"><i class="ph ph-mastodon-logo"></i> Mastodon</a><li><a href="mailto:mike@shellsharks.com" ><i class="ph ph-envelope"></i> Email</a><li><a href="https://ko-fi.com/shellsharks" ><i class="ph ph-coffee"></i> Buy me a Coffee</a><li id="themetoggler"><i class="ph ph-swatches" id="themetoggle"></i> Toggle theme<li class="menu_section">Site Nav<li><a href="/scrolls" ><i class="ph ph-scroll"></i> Scrolls Newsletter</a><li><a href="/podcast" ><i class="ph ph-microphone"></i> The Shellsharks Podcast</a><li><a href="/notebook" ><i class="ph ph-note"></i> Notebook</a><li><a href="/blogs" ><i class="ph ph-article"></i> Blogs</a><li><a href="/blogs/infosec" ><i class="ph ph-bug"></i> Infosec Blogs</a><li><a href="/captains-log" ><i class="ph-fill ph-notebook"></i> Captain's Log</a><li><a href="/devlog" ><i class="ph ph-code-block"></i> Devlog</a><li><a href="/linklog" ><i class="ph ph-link"></i> Linklog</a><li><a href="/blogroll" ><i class="ph ph-paint-roller"></i> Blogroll</a><li><a href="/fediverse" ><i class="ph ph-fediverse-logo"></i> Fediverse ‚ÅÇ</a><li><a href="/slashes" ><i class="ph ph-folder-simple-star"></i> Slashes</a><li><a href="/uses" ><i class="ph ph-hammer"></i> Uses</a><li><a href="/now" ><i class="ph ph-clock"></i> Now</a><li><a href="/tags" ><i class="ph ph-tag"></i> Tags</a><li><a href="/statboard" ><i class="ph ph-gauge"></i> Statboard</a><li><a href="/changelog" ><i class="ph ph-arrows-left-right"></i> Change Log</a><li><a href="/interests" ><i class="ph ph-heart"></i> Interests</a><li><a href="/ideas" ><i class="ph ph-lightbulb-filament"></i> Ideas</a><li><a href="/bookmarks" ><i class="ph ph-bookmarks"></i> Bookmarks</a><li><a href="/resume" ><i class="ph ph-read-cv-logo"></i> Resume</a><li><a href="/pro" ><i class="ph ph-seal"></i> Shellsharks Pro</a><li><a href="/sharkweek" ><i class="ph ph-calendar-heart"></i> >Shark Week</a><li><a href="/architecture" ><i class="ph ph-blueprint"></i> Architecture</a><li><a href="/roadmap" ><i class="ph ph-road-horizon"></i> Roadmap</a><li><a href="/tags?tag=bestof#info" ><i class="ph ph-star"></i> Best</a><li><a href="/projects" ><i class="ph ph-compass-tool"></i> Projects</a><li><a href="/now#supporting" ><i class="ph ph-hand-heart"></i> Supports</a><li><a href="/uses#referrals" ><i class="ph ph-hand-arrow-up"></i> Referrals</a><li><a href="/style" ><i class="ph ph-frame-corners"></i> Style</a><li><a href="/.well-known/security.txt" ><i class="ph ph-bug"></i> Report a Bug</a><li><a href="/humans.txt" ><i class="ph ph-user-rectangle"></i> Humans</a><li><a href="/disclaimer" ><i class="ph ph-info"></i> License & Disclaimer</a><li><a href="/privacy" ><i class="ph ph-cookie"></i> Privacy</a><li><a href="/starsharks" ><i class="ph ph-sparkle"></i> Starsharks</a><li><a href="/chipotle" ><i class="ph ph-pepper"></i> Chipotle</a><li><a href="/misc" ><i class="ph ph-paperclip"></i> Junk Drawer</a><li><a href="/ocean" ><i class="ph ph-waves"></i> the Ocean</a><li><a href="/void" ><i class="ph ph-spiral"></i> the Void</a><li class="menu_section">Other<li><a href="/public.pgp" ><i class="ph ph-key"></i> PGP Public Key</a><li><a href="https://infosec.pub/c/cybersecurity" target="_blank"><i class="ph ph-hamburger"></i> Infosec.Pub</a><li><a href="https://malici.ous.computer/@shellsharks" target="_blank"><i class="ph ph-linux-logo"></i> malici.ous.computer</a><li><a href="https://mastodon.social/@sass" target="_blank"><i class="ph-fill ph-mastodon-logo"></i> Mastodon.Social</a><li><a href="https://discord.gg/3rkHgtcYbb" target="_blank"><i class="ph ph-discord-logo"></i> Shellsharks Discord</a><li><a href="https://www.linkedin.com/in/mikesass" target="_blank"><i class="ph ph-linkedin-logo"></i> Linkedin</a><li><a href="/toots/infosec-exchange/shellsharks/" ><i class="ph ph-database"></i> Infosec.exchange Toot Archive</a><li><a href="https://github.com/shellsharks" target="_blank"><i class="ph ph-github-logo"></i> Github</a><li><a href="https://fediverse-webring-enthusiasts.glitch.me/profiles/shellsharks_infosec.exchange/index.html" target="_blank"><i class="ph ph-circle"></i> Webring Enthusiasts</a><li><a href="https://fedia.io/m/cybersecurity" target="_blank"><i class="ph ph-square-half"></i> Fedia.io</a></ul></nav><main class="container_item"><div class="pageheader"></div><article class="post h-entry"><header class="post-header"><h1 class="post-title p-name" id="title" style="display:inline;">CSC at Home (Part 2): Software Inventory and Control</h1><span style="color:#CA3342;font-size:4em;line-height: 20px;">.</span></header><!--<div id="postinfo"> <span class="time"><i class="ph ph-note-pencil"></i> by <span class="hov p-author h-card">Mike Sass</span> <a href="/about" rel="author"><img class="u-photo" src="https://shellsharks-images.s3.amazonaws.com/surfshark.png" style="display:inline; height:1em;" /></a></span><br/> <br/> <span class="categories"> &raquo; infosec, blog </span></div>--><div class="post-content e-content" style="margin-top: 30px;"><p>Welcome to part 2 of my <a href="/csc-at-home-part-1">CSC at Home</a> series where I provide practical guidance on how one could implement the <a href="https://www.cisecurity.org/controls/">CIS Top 20 controls</a> in their home or small-business environment.<div class="containbox">This post, as part of a 3-part series are all pieces I had sitting in my drafts folder since the beginning of 2021. As such, they cover a version of the CIS Critical Security Controls that is rather old at this point. Still, I thought the content relevant and interesting enough to publish (as-was), even after all these years. Let me know what you think!</div><h1 id="cis-control-2-inventory-and-control-of-software-assets">CIS Control 2: Inventory and Control of Software Assets</h1><p>The second CIS control is reminiscent of <a href="/csc-at-home-part-1#title">the first</a>. Rather than hardware inventory however, this control deals with the inventory and control specifically of <em>software</em>. The relevant sub-controls for an Implementation Group 1 (IG1) environment are listed below.<ul><li><strong>Sub-Control 2.1</strong>: <a href="#maintain-an-inventory-of-authorized-software-sub-control-21">Maintain Inventory of Authorized Software</a><li><strong>Sub-Control 2.2</strong>: <a href="#ensure-software-is-supported-by-vendor-sub-control-22">Ensure Software is Supported by Vendor</a><li><strong>Sub-Control 2.6</strong>: <a href="#address-unapproved-software-sub-control-26">Address Unapproved Software</a></ul><h2 id="security-value">Security Value</h2><p>Maintenance and routine audit of installed software is key to a secure environment. For each piece of installed software, there is added potential for vulnerability due to increased attack surface. The first step to securing your network is to understand what is on the network, and the first step to securing any individual system on that network is to understand the software that is installed on that system. Subsequently, software should be evaluated to determine whether it is still in active support by the vendor and finally, any unapproved software should be removed from the system. If software is no longer in support by the vendor, it will likely not receive future security updates and therefore may pose a more serious risk to the system. Unauthorized software may be malicious in nature or pose inadvertent risk to the system.<h2 id="maintain-an-inventory-of-authorized-software-sub-control-21">Maintain an Inventory of Authorized Software (Sub-Control 2.1)</h2><p>Let‚Äôs start with sub-control 2.1 which asks that we maintain an up-to-date list of all <em>authorized</em> software. This inventory can be thought of as a ‚Äúwhitelist‚Äù - anything not on this list is considered unauthorized and therefore should be removed from the system. To create this whitelist, we need to interrogate the systems on the network for what software is currently installed. A network scanning tool such as <a href="https://www.openvas.org">OpenVAS</a> or <a href="https://www.tenable.com/products/nessus">Nessus</a> can do just that!<p>In the <a href="/csc-at-home-part-1#title">first part of this series</a> I went over <a href="/csc-at-home-part-1#openvas-installation--usage">the steps for getting up and running with OpenVAS</a>. Take a look at these steps and then follow along with the steps below.<h3 id="openvas-authenticated-scanning">OpenVAS Authenticated Scanning</h3><p>To enumerate software on an endpoint, we will need to be able to authenticate to that endpoint from our scanner. For Linux devices, this means authentication over SSH and for Windows, over SMB. Linux servers will typically have a listening SSH service but if not, it is trivially installed on Linux with the following command.<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>openssh-server
</code></pre></div></div><p>You can validate the server is enabled and listening as shown below.<p><img src="https://shellsharks-images.s3.amazonaws.com/cis-at-home/control2/sshdstatus.png" alt="sshd" /><p>To get started with authenticated scanning using OpenVAS we need to first create a new <em>Credential</em>. This can be done by going to <em>Configuration</em>‚Äì&gt;<em>Credentials</em>. Just give it a name, select the type of credential and input the username and password. For SSH, username and password will work, though <a href="https://www.ssh.com/ssh/keygen/">key-based auth</a> is recommended. Similarly for Windows, a username and password can be created. It is also recommended that service accounts (a non-user account) are created for scanning purposes. This way, the scanner can easily be configured with this service account for authenticating to remote machines.<p><img src="https://shellsharks-images.s3.amazonaws.com/cis-at-home/control2/newcredential.png" alt="Credential" /><p>Once we have a credential, let‚Äôs create a new Target list. Navigate to <em>Configuration</em>‚Äì&gt;<em>Targets</em> and then create a Target and associate the credential you just created.<p><strong>TIP</strong>: You can associate more than one credential with a target list.<p><img src="https://shellsharks-images.s3.amazonaws.com/cis-at-home/control2/addcheckstohost.png" alt="targetwithcredential" /><p>Now that we have a Target with associated credentials, we can create a new Scan by going to <em>Scans</em>‚Äì&gt;<em>Tasks</em> and creating a new Task with the Scan Targets as the newly created target and the Scan Config being set to ‚ÄúFull and fast‚Äù. Be sure to give the scan task a useful Name.<p>With the scan task created, we can run the it! Give it some time to finish.<p><strong>TIP</strong>: Authenticated scans typically finish quicker than unauthenticated scans. This is because the act of local enumeration is much more efficient than remote fingerprinting.<p>Once the scan finishes, click on the ‚ÄúDone‚Äù area of the scan record to view the report. Inside this report (once the default filters have been removed), you can see the results, hosts, ports, etc‚Ä¶ The tab of interest for software inventory is the ‚ÄúApplications‚Äù tab. In here, we can see a list of <a href="https://nvd.nist.gov/products/cpe">Application CPE</a> values. In this list we can not only see the list of applications, but also the installed versions of those applications. Awesome! We now have an inventory of software for this system.<p>This list should be evaluated for each scanned system to determine if any of the software is ‚Äúunauthorized‚Äù and should therefore be removed from this system and any other system that the software is on. If there are known vulnerabilities with any specific piece of software, this will show up in the ‚Äúfindings‚Äù tab of the scan report and should be addressed for that reason as well.<h4 id="troubleshooting-authenticated-scanning">Troubleshooting Authenticated Scanning</h4><p>There are a number of issues you may encounter when configuring and running authenticated scans with OpenVas. With both Linux and Windows, you will want to make sure the account you are authenticating as has proper permissions on the remote system. This means having <em>root</em> (or sudo) privileges on Linux and <em>Administrator</em> privileges on Windows. For Windows systems, there are a few additional things you will want to ensure are enabled prior to scanning.<ul><li><em>File and Printer Sharing</em> must be enabled within the Windows Firewall settings.<li><em>Allow inbound file and printer exception</em> setting within local group policy must be enabled.<li>The setting ‚Äú<em>Prohibit use of Internet connection firewall on your DNS domain</em>‚Äù must be set to <em>Disabled</em> in the systems local group policy.<li>The <em>Remote Registry</em> service must be enabled.</ul><p>Some additional resources for troubleshooting authenticated scans are provided below.<ul><li><a href="https://community.greenbone.net/t/hint-verify-target-configuration-access-for-authenticated-lsc-scans/219">Authenticated Scanning w/ OpenVAS</a><li><a href="https://docs.tenable.com/nessus/Content/CredentialedChecksOnWindows.htm">Authenticated Scanning w/ Nessus</a></ul><h2 id="ensure-software-is-supported-by-vendor-sub-control-22">Ensure Software is Supported by Vendor (Sub-Control 2.2)</h2><p>When software becomes end-of-life, this means the vendor does not intend on releasing security patches for that respective piece of software. When new vulnerabilities are discovered, these risks will go unaddressed and the security posture of your environment will be degraded. The software list we generated in the previous sub-control should be regularly reviewed to determine whether any individual item is no longer supported by the vendor. The software inventory includes version numbers which can be used to help facilitate this task.<p><img src="https://shellsharks-images.s3.amazonaws.com/cis-at-home/control2/appcpe.png" alt="CPE List" /><h2 id="address-unapproved-software-sub-control-26">Address Unapproved Software (Sub-Control 2.6)</h2><p>When software is identified, via scanning operations, that is not explicitly ‚Äúapproved‚Äù, it should be removed from a system. A technical control for implementing this concept is ‚ÄúApplication Whitelisting‚Äù. Application whitelisting is essentially a piece of software that enforces what other software is allowed to be installed on a system. Any item that is <em>not</em> on the whitelist will be blocked from being installed. New software items can be added with business justification. Application whitelisting on Linux can be achieved through the <a href="http://github.com/linux-application-whitelisting/fapolicyd">File Access Policy Daemon</a>. On Windows, <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/applocker/applocker-overview">AppLocker</a> can be used for software whitelisting. Here‚Äôs another <a href="https://www.tiraniddo.dev/2019/11/the-internals-of-applocker-part-1.html">great and very technical guide series for standing up AppLocker</a>.<h2 id="the-automation-dilemma">The Automation Dilemma</h2><p>Inventory and control of software assets for an IG1-class organization comes down to three things‚Ä¶<ol><li>Maintain an inventory of authorized software.<li>Ensure software is supported by the vendor.<li>Address unapproved software.</ol><p>Achieving these three things is made much easier through the use of <em>automation</em>. The community version of OpenVAS has some limitations when it comes to automating via the GSM API. Without automation, a lot of the work described above is manually performed, week after week. At a small scale (which is the case with IG-1 environments) this may not require too much work but as the network grows in size, so too will the work required to achieve proper software inventory and control. This is where automation steps in.<h1 id="next-in-the-series">Next in the Series</h1><p>Thanks for reading! The next chapter in the <em>CIS at Home</em> series covers <strong>Control 3</strong>: <a href="/csc-at-home-part-3#title">Continuous Vulnerability Management</a>.<h1 id="previously-in-the-series">Previously in the Series</h1><p>The previous chapter in the <em>CIS at Home</em> series covers <strong>Control 1</strong>: <a href="/csc-at-home-part-1#title">Inventory and Control of Hardware Assets</a>.</div></article><hr class="fin"><div id="poststats" class="containbox" style="margin: auto;"> <span class="time"><i class="ph ph-calendar-dot"></i> Published: <span class="dt-published">May 12, 2024</span></span> <a class="u-url u-uid" href></a><br> <span class="categories"><i class="ph ph-tag"></i> Tags: <span class="primarybg" style="border-radius:15px;padding:0px 5px 0px 5px;"><a class="p-category" href="/tags?tag=infosec">#infosec</a></span> <span class="primarybg" style="border-radius:15px;padding:0px 5px 0px 5px;"><a class="p-category" href="/tags?tag=cis">#cis</a></span> <span class="primarybg" style="border-radius:15px;padding:0px 5px 0px 5px;"><a class="p-category" href="/tags?tag=csc">#csc</a></span> <span class="primarybg" style="border-radius:15px;padding:0px 5px 0px 5px;"><a class="p-category" href="/tags?tag=openvas">#openvas</a></span> <span class="primarybg" style="border-radius:15px;padding:0px 5px 0px 5px;"><a class="p-category" href="/tags?tag=vm">#vm</a></span> <span class="primarybg" style="border-radius:15px;padding:0px 5px 0px 5px;"><a class="p-category" href="/tags?tag=scanning">#scanning</a></span> <span class="primarybg" style="border-radius:15px;padding:0px 5px 0px 5px;"><a class="p-category" href="/tags?tag=blopomo">#blopomo</a></span> <span class="primarybg" style="border-radius:15px;padding:0px 5px 0px 5px;"><a class="p-category" href="/tags?tag=weblogpomo2024">#weblogpomo2024</a></span> </span><br/> <span class="time"><i class="ph ph-pencil"></i> Word count: 1456</span> <span class="p-summary" style="display:none;">Practical guidance for implementing CIS Control 2, Inventory and Control of Software Assets, in small environments.</span><div style="color:var(--secondary-font-color);"> <i class="ph ph-broadcast"></i><span> Syndicated To:</span> <span style="padding:0px 3px 0px 3px;"><a href="https://shellsharks.social/@shellsharks/112428301934010643"><i class="ph ph-mastodon-logo" title="Mastodon" style="font-size:1.25em;"></i></a></span></div></div><br/><div class="PageNavigation"> <a class="prev" style="margin-right: 2em;" href="/csc-at-home-part-1#title">&laquo; CSC at Home (Part 1): Hardware Inventory and Control</a><div style="float:right;"><a class="next" href="/csc-at-home-part-3#title" style="margin-right:0;">CSC at Home (Part 3): Vulnerability Management &raquo;</a></div></div></main><aside class="container_item"></aside><footer class="container_item"> <center><span style="color:var(--light-font-color); font-size:.8em; font-style:italic; position:relative; top:25px;">Brought to you with <i class="ph-fill ph-heart-straight" style="color:var(--accent-color);"></i> by <a href="https://shellsharks.com/about">Shellsharks</a></span></center> <center> <img id="sharkfooter" src="/assets/img/sharks-circling.png" alt="Circling Sharks" style="width:150px;"></img> </center></footer></div><noscript><div class="panel" align="center" style="font-weight:bold;"><h1>Please enable JavaScript.</h1></div></noscript> <script src="/assets/js/themeswitcher.js"></script>
